## Aandoeningen en Klachten in Haarlem
### een weergave voor patiënten van het Therapeuticum Haarlem, 
door Pim van Alphen, Assistent-Kwaliteitscoordinator aan het Therapeuticum Haarlem

#### Introductie
Ik heb een visualisatie gemaakt die, op basis van patiëntengegevens van de huisartsenpraktijk waar ik werk, voor een gekozen aandoeningen of klacht laat zien in welk gebied in Haarlem deze het meeste voorkomt. Haarlem is schematisch weergegeven met een kaart die onderverdeeld kan worden in zeven wijken en 42 buurten, waarbij elke wijk uit een aantal buurten bestaat. Via een zoekveld kan gezocht worden naar aandoeningen op basis van de indeling zoals die wordt gebruikt in de huisartsenpraktijk, met de zogenaamde ICPC codes. Is er een aandoening of ICPC code geselecteerd, dan wordt de schematische kaart ingekleurd en verschijnt er een bar chart. Deze geven weer hoeveel patiënten er per wijk deze aandoening als episode in hun patiëntendossier hebben staan. De kaart doet dat op basis van kleur, de bar chart doet dat op basis van de hoogte van de bars. Via twee knoppen kan de weergave van de data aangepast worden. De eerste knop veranderd de indeling van de kaart in buurten of in wijken. Ook de barchart wordt aangepast op basis van de gekozen weergave. De tweede knop maakt het mogelijk te wisselen tussen een weergave van het totaal aantal episodes per wijk en een weergave van het aantal episodes per wijk per patiënt uit die wijk. Beide getallen staan ook weergegeven in de bar chart, maar de bars staan gesorteerd op basis van de geselecteerde weergave. 

#### Technical design
De visualisatie bestaat uit twee onderdelen: de schematische kaart en de bar chart. Deze twee onderdelen zijn verbonden met elkaar en worden beide aangepast basis van de zoekopdracht in het zoekveld en de configuratie van de knoppen. Zie hieronder voor een beknopte beschrijving van de functionaliteit van de verschillende onderdelen.
- Schematische kaart: de kaart bestaat uit verschillende vlakken die de verschillende buurten en wijken van Haarlem representeren. Deze worden ingekleurd op basis van de geselecteerde weergave opties en de patiëntendata, zodat in elk gebied te zien is hoeveel patiënten er in dat gebied wonen, die de geselecteerde aandoening als episode in hun patiëntendossier hebben. Als er met de muis over de kaart bewogen wordt, wordt een tool tip weergegeven die laat zie wat de naam van het gebied is, hoeveel patiënten er wonen en hoeveel patiënten er wonen die voldoen aan het zoekcriterium. Daarnaast wordt het gebied gehighlight, evenals de corresponderende bar in de bar chart. Bij de highlight in de bar chart wordt ook rekening gehouden met de gekozen weergave opties, zodat als de  map het totaal aantal episodes weergeeft ook de bar die het totaal aantal episodes weergeeft highlight. Naast de kaart bevind zich een legenda die de kleurrange weergeeft en daarnaast laat zien van de maximale waarden zijn.
- Barchart: de barchart geeft de totale aantallen episodes per buurt of wijk weer, evenals het aantal geselecteerde episodes per patiënt. Zo ontstaat er een grouped bar chart, die gebruik maakt van twee assen. De positie van de assen komt overeen met de positie van de bars. De bar chart past zich aan op de gekozen weergave opties, en sorteert zich van hoog naar laag en van links naar rechts of rechts naar links, voor de weergave van respectievelijk het totale aantal en de ratio. De bars en assen veranderen dynamisch wanneer er een andere episode wordt geselecteerd. Interactie met de bars vindt plaats door er met de muis overheen te gaan, de bar zal highlighten, evenals het corresponderende gebied op de kaart. Daarnaast zal een tool tip de waarde van de bar laten zien. 
- De weergave opties:
   * Zoekveld: hierin kan worden gezocht naar aandoeningen en klachten op basis van de naam of door het huisartsen informatie systeem gebruikte ICPC code. Op basis van de invoer geeft het veld een selectie van corresponderende aandoeningen weer, waaruit een item geselecteerd kan worden. Het is alleen mogelijk een selectie te maken door op één van de weergegeven opties te klikken (of met het toetsenbord te selecteren, maar het is dus niet mogelijk door middel van vrijelijk typen een selectie te maken.
   * Buurt/Wijk-knop: deze knop bevindt zich onder het zoekveld en biedt de mogelijkheid om de waarden per wijk of per buurt weer te geven. Er zijn zeven wijken en 42 buurten in Haarlem. Een wijziging in weergave heeft invloed op zowel de kaart als de barchart. De knop geeft zelf weer wat er weergegeven wordt, en dit kan gewijzigd worden met een simpele druk op de knop (no pun intended). 
   * Totaal/Ratio-knop: deze knop heeft dezelfde functionaliteit als de knop die hiervoor beschreven is, alleen biedt deze de mogelijkheid om te wisselen tussen een weergave van het totale aantal episoden per gebied en een weergave van het aantal episoden per patiënt in dat gebied. De barchart zal zich sorteren op basis van de geselecteerde weergave. 

#### Proces 
In het proces zijn er een aantal keuzemomenten geweest met betrekking tot de visualisatie:
- Privacy: omdat de visualisatie gebruikt maakt van gevoelige patiëntengegevens, moest er rekening gehouden worden met de privacy van de patiënten. De verstrekte informatie mag onder geen beding leiden tot de identificatie van specifieke personen, zonder dat daarvoor excessieve arbeid nodig is. Ik heb meerdere aanpassingen aan de data gedaan om de privacy van de patiënten te kunnen waarborgen. Ten eerste heb ik geen gevoelige patiënten gegevens gebruikt. Ik heb alleen gebruikt gemaakt van de episodelijst van patiënten en van de postcode van patiënten. De postcode heb ik omgeschreven naar een wijkcode met behulp van een stratenlijst van de Gemeente Haarlem. De episodes geven weinig gevoelige informatie, maar voor de zekerheid heb ik ervoor gezorgd dat het niet mogelijk is om te zoeken op codes specifieker dan alleen de hoofdcode en het eerst getal van de sub code. Ten tweede laat de kaart nooit minder dan vijf patiënten per wijk zien, ook al zijn het er misschien minder dan vijf (het eigenlijke aantal kan zelfs nul zijn). Dit interfereert niet met het doel van de visualisatie, er is namelijk nog steeds goed te zien waar de meeste patiënten zich bevinden. Het weergeven van de minste aantal patiënten was niet het primaire doel. Zonder deze aanpassing zou het misschien mogelijk zijn om een patiënt met een nog steeds aardig specifieke aandoening in een bepaalde wijk te kunnen lokaliseren, omdat deze de enige is met deze aandoening in de specifieke wijk. 	

- Codering van de waarden: de gegevens die gebruikt zijn voor de visualisatie zijn niet meer dan een lijst van een combinatie van de wijkcode met een episode. Ik wilde sowieso de totale aantallen weergeven per gebied, maar als er in een bepaald gebied nou eenmaal veel patiënten wonen, dan is het logisch dat een bepaalde aandoening daar absoluut gezien vaak voor komt. Maar het is ook interessant om iets meer te kunnen zeggen over deze getallen. Daarom heb ik ervoor gekozen om ook het aantal episoden per patiënt weer te geven. Aangezien elke patiënt maar één keer een bepaalde episode kan hebben, leent deze aanpak zich goed voor deze data. 

- Codering van de kaart: ik heb ervoor gekozen om de kaart te coderen met kleur, aangezien ik de plek al wilde gebruiken voor het weergeven van de kaart. Een kaart leende zich voor mijn gevoel goed voor het onderwerp dat ik had gekozen, namelijk het aantal episodes per wijk of buurt. Het zou vreemd zijn om geografische data niet weer te geven als een kaart. Ik had de aantallen op de kaart nog kunnen coderen met getallen of in zwart wit, maar ik vond kleur gewoonweg mooier en het maakte het makkelijker om de outlines van de kaart ongewijzigd te laten (zwarte outlines naast zwart gekleurde vlakker verliezen contrast). Ik heb gekozen voor een lineair kleurschema die van wit naar donkerblauw loopt. Een lineair schema was een logische keuze aangezien de data ook lineair was, er waren geen duidelijke categorieën in de aantallen episodes, dus deze heb ik er ook niet in geforceerd. Het domein van de schaal reikte van de laagste tot de hoogste waarde. Ik heb hiervoor gekozen (de andere optie zou zijn van nul tot de hoogste waarde) zodat er een goed contrast ontstaat tussen de verschillende wijken, zodat de kans groter is dat er in één oogopslag zichtbaar is in welk gebied zich de meeste patiënten bevinden.
 
- Codering van de barchart: Ik wilde naast de kaart nog specifieker de data weergeven, en ik heb ervoor gekozen om de aantallen weer te geven in een grouped bar chart. Ik heb voor een barchart gekozen omdat hiermee makkelijk de verschillende waarden met elkaar te vergelijken zijn, iets dat op de kaart niet kan aangezien het hier lastig is de waardes in één oogopslag af te lezen. Daarnaast is het in een barchart makkelijker om te zien waar de hoogste (en laagste) waarde zich bevind, aangezien deze zich automatisch sorteerd. De rede dat ik voor een grouped bar chart heb gekozen is dat dit de enige mogelijkheid is om tegelijkertijd de absolute en de relatieve waarde van een wijk te zien, zonder dat hiervoor via de knop de weergave gewijzigd hoeft te worden.
